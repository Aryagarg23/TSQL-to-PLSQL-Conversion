SELECT * FROM ( SELECT p_name , p_mfgr , p_brand , p_type , p_size , p_container , p_retailprice , p_comment , qty , qty * p_retailprice FROM ( SELECT l_partkey partkey , SUM (l_quantity) qty FROM lineitem WHERE l_orderkey IN ( SELECT o_orderkey FROM orders WHERE o_orderdate = To_date ( '1996 - 04 - 30' , 'YYYY - MM - DD') AND o_orderpriority = '1 - URGENT' AND o_totalprice > 480000) GROUP BY l_partkey) PartiallyFullfiledOrders , part WHERE p_partkey = PartiallyFullfiledOrders .  partkey ORDER BY qty * p_retailprice) WHERE ROWNUM <= 10